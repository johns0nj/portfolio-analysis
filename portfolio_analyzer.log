2025-01-27 22:12:49,188 - portfolio_analyzer - INFO - Starting portfolio analysis
2025-01-27 22:12:49,198 - portfolio_analyzer - INFO - Analyzing portfolio: {'AAPL': 0.4, 'MSFT': 0.3, 'GOOGL': 0.3}
2025-01-27 22:12:49,199 - portfolio_analyzer - INFO - Time period: 2020-01-01 to 2023-10-01
2025-01-27 22:12:49,199 - portfolio_analyzer - DEBUG - Fetching stock data...
2025-01-27 22:12:51,793 - portfolio_analyzer - DEBUG - Processing stock data...
2025-01-27 22:12:51,794 - portfolio_analyzer - ERROR - An error occurred during portfolio analysis: 'dict' object has no attribute 'head'
Traceback (most recent call last):
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\main.py", line 57, in main
    print(processed_data.head())
          ^^^^^^^^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'head'
2025-01-27 22:13:57,649 - portfolio_analyzer - INFO - Starting portfolio analysis
2025-01-27 22:13:57,659 - portfolio_analyzer - INFO - Analyzing portfolio: {'AAPL': 0.4, 'MSFT': 0.3, 'GOOGL': 0.3}
2025-01-27 22:13:57,659 - portfolio_analyzer - INFO - Time period: 2020-01-01 to 2023-10-01
2025-01-27 22:13:57,660 - portfolio_analyzer - DEBUG - Fetching stock data...
2025-01-27 22:13:59,050 - portfolio_analyzer - DEBUG - Processing stock data...
2025-01-27 22:13:59,071 - portfolio_analyzer - DEBUG - Calculating portfolio metrics...
2025-01-27 22:13:59,072 - portfolio_analyzer - ERROR - Error calculating portfolio returns: 'Adj Close'
2025-01-27 22:13:59,072 - portfolio_analyzer - ERROR - An error occurred during portfolio analysis: 'Adj Close'
Traceback (most recent call last):
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Adj Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\main.py", line 74, in main
    metrics = calculate_portfolio_metrics(processed_data, portfolio)
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\calculations.py", line 188, in calculate_portfolio_metrics
    portfolio_returns = calculate_portfolio_returns(processed_data, portfolio_weights)
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\calculations.py", line 36, in calculate_portfolio_returns
    price_data[ticker] = data['Adj Close']
                         ~~~~^^^^^^^^^^^^^
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\frame.py", line 4101, in __getitem__
    return self._getitem_multilevel(key)
           ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\frame.py", line 4159, in _getitem_multilevel
    loc = self.columns.get_loc(key)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\multi.py", line 3040, in get_loc
    loc = self._get_level_indexer(key, level=0)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\multi.py", line 3391, in _get_level_indexer
    idx = self._get_loc_single_level_index(level_index, key)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\multi.py", line 2980, in _get_loc_single_level_index
    return level_index.get_loc(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'Adj Close'
2025-01-27 22:14:26,799 - portfolio_analyzer - INFO - Starting portfolio analysis
2025-01-27 22:14:26,800 - portfolio_analyzer - INFO - Analyzing portfolio: {'AAPL': 0.4, 'MSFT': 0.3, 'GOOGL': 0.3}
2025-01-27 22:14:26,800 - portfolio_analyzer - INFO - Time period: 2020-01-01 to 2023-10-01
2025-01-27 22:14:26,801 - portfolio_analyzer - DEBUG - Fetching stock data...
2025-01-27 22:14:28,176 - portfolio_analyzer - DEBUG - Processing stock data...
2025-01-27 22:14:28,195 - portfolio_analyzer - DEBUG - Calculating portfolio metrics...
2025-01-27 22:14:28,196 - portfolio_analyzer - ERROR - Error calculating portfolio returns: 'Adj Close'
2025-01-27 22:14:28,196 - portfolio_analyzer - ERROR - An error occurred during portfolio analysis: 'Adj Close'
Traceback (most recent call last):
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Adj Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\main.py", line 74, in main
    metrics = calculate_portfolio_metrics(processed_data, portfolio)
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\calculations.py", line 188, in calculate_portfolio_metrics
    portfolio_returns = calculate_portfolio_returns(processed_data, portfolio_weights)
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\calculations.py", line 36, in calculate_portfolio_returns
    price_data[ticker] = data['Adj Close']
                         ~~~~^^^^^^^^^^^^^
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\frame.py", line 4101, in __getitem__
    return self._getitem_multilevel(key)
           ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\frame.py", line 4159, in _getitem_multilevel
    loc = self.columns.get_loc(key)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\multi.py", line 3040, in get_loc
    loc = self._get_level_indexer(key, level=0)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\multi.py", line 3391, in _get_level_indexer
    idx = self._get_loc_single_level_index(level_index, key)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\multi.py", line 2980, in _get_loc_single_level_index
    return level_index.get_loc(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'Adj Close'
2025-01-27 22:24:15,432 - portfolio_analyzer - INFO - Starting portfolio analysis
2025-01-27 22:24:15,433 - portfolio_analyzer - INFO - Analyzing portfolio: {'AAPL': 0.4, 'MSFT': 0.3, 'GOOGL': 0.3}
2025-01-27 22:24:15,433 - portfolio_analyzer - INFO - Time period: 2020-01-01 to 2023-10-01
2025-01-27 22:24:15,434 - portfolio_analyzer - DEBUG - Fetching stock data...
2025-01-27 22:24:16,851 - portfolio_analyzer - DEBUG - Processing stock data...
2025-01-27 22:24:16,852 - portfolio_analyzer - ERROR - An error occurred during portfolio analysis: 'dict' object has no attribute 'head'
Traceback (most recent call last):
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\main.py", line 57, in main
    print(processed_data.head())
          ^^^^^^^^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'head'
2025-01-27 22:25:37,066 - portfolio_analyzer - INFO - Starting portfolio analysis
2025-01-27 22:25:37,066 - portfolio_analyzer - INFO - Analyzing portfolio: {'AAPL': 0.4, 'MSFT': 0.3, 'GOOGL': 0.3}
2025-01-27 22:25:37,067 - portfolio_analyzer - INFO - Time period: 2020-01-01 to 2023-10-01
2025-01-27 22:25:37,067 - portfolio_analyzer - DEBUG - Fetching stock data...
2025-01-27 22:25:38,563 - portfolio_analyzer - DEBUG - Processing stock data...
2025-01-27 22:25:38,564 - portfolio_analyzer - ERROR - An error occurred during portfolio analysis: 'dict' object has no attribute 'head'
Traceback (most recent call last):
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\main.py", line 57, in main
    print(processed_data.head())
          ^^^^^^^^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'head'
2025-01-27 22:27:18,378 - portfolio_analyzer - INFO - Starting portfolio analysis
2025-01-27 22:27:18,379 - portfolio_analyzer - INFO - Analyzing portfolio: {'AAPL': 0.4, 'MSFT': 0.3, 'GOOGL': 0.3}
2025-01-27 22:27:18,380 - portfolio_analyzer - INFO - Time period: 2020-01-01 to 2023-10-01
2025-01-27 22:27:18,380 - portfolio_analyzer - DEBUG - Fetching stock data...
2025-01-27 22:27:19,853 - portfolio_analyzer - DEBUG - Processing stock data...
2025-01-27 22:27:19,854 - portfolio_analyzer - DEBUG - Calculating portfolio metrics...
2025-01-27 22:27:19,854 - portfolio_analyzer - ERROR - Error calculating portfolio returns: 'Adj Close'
2025-01-27 22:27:19,855 - portfolio_analyzer - ERROR - An error occurred during portfolio analysis: 'Adj Close'
Traceback (most recent call last):
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Adj Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\main.py", line 59, in main
    metrics = calculate_portfolio_metrics(processed_data, portfolio)
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\calculations.py", line 188, in calculate_portfolio_metrics
    portfolio_returns = calculate_portfolio_returns(processed_data, portfolio_weights)
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\calculations.py", line 36, in calculate_portfolio_returns
    price_data[ticker] = data['Adj Close']
                         ~~~~^^^^^^^^^^^^^
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\frame.py", line 4101, in __getitem__
    return self._getitem_multilevel(key)
           ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\frame.py", line 4159, in _getitem_multilevel
    loc = self.columns.get_loc(key)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\multi.py", line 3040, in get_loc
    loc = self._get_level_indexer(key, level=0)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\multi.py", line 3391, in _get_level_indexer
    idx = self._get_loc_single_level_index(level_index, key)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\multi.py", line 2980, in _get_loc_single_level_index
    return level_index.get_loc(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'Adj Close'
2025-01-27 22:28:53,103 - portfolio_analyzer - INFO - Starting portfolio analysis
2025-01-27 22:28:53,103 - portfolio_analyzer - INFO - Analyzing portfolio: {'AAPL': 0.4, 'MSFT': 0.3, 'GOOGL': 0.3}
2025-01-27 22:28:53,103 - portfolio_analyzer - INFO - Time period: 2020-01-01 to 2023-10-01
2025-01-27 22:28:53,104 - portfolio_analyzer - DEBUG - Fetching stock data...
2025-01-27 22:28:54,530 - portfolio_analyzer - DEBUG - Processing stock data...
2025-01-27 22:28:54,531 - portfolio_analyzer - DEBUG - Calculating portfolio metrics...
2025-01-27 22:28:54,531 - portfolio_analyzer - ERROR - Error calculating portfolio returns: 'Adj Close'
2025-01-27 22:28:54,532 - portfolio_analyzer - ERROR - An error occurred during portfolio analysis: 'Adj Close'
Traceback (most recent call last):
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Adj Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\main.py", line 59, in main
    metrics = calculate_portfolio_metrics(processed_data, portfolio)
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\calculations.py", line 188, in calculate_portfolio_metrics
    portfolio_returns = calculate_portfolio_returns(processed_data, portfolio_weights)
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\calculations.py", line 36, in calculate_portfolio_returns
    price_data[ticker] = data['Adj Close']
                         ~~~~^^^^^^^^^^^^^
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\frame.py", line 4101, in __getitem__
    return self._getitem_multilevel(key)
           ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\frame.py", line 4159, in _getitem_multilevel
    loc = self.columns.get_loc(key)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\multi.py", line 3040, in get_loc
    loc = self._get_level_indexer(key, level=0)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\multi.py", line 3391, in _get_level_indexer
    idx = self._get_loc_single_level_index(level_index, key)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\multi.py", line 2980, in _get_loc_single_level_index
    return level_index.get_loc(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'Adj Close'
2025-01-27 22:29:14,879 - portfolio_analyzer - INFO - Starting portfolio analysis
2025-01-27 22:29:14,880 - portfolio_analyzer - INFO - Analyzing portfolio: {'AAPL': 0.4, 'MSFT': 0.3, 'GOOGL': 0.3}
2025-01-27 22:29:14,880 - portfolio_analyzer - INFO - Time period: 2020-01-01 to 2023-10-01
2025-01-27 22:29:14,880 - portfolio_analyzer - DEBUG - Fetching stock data...
2025-01-27 22:29:16,204 - portfolio_analyzer - DEBUG - Processing stock data...
2025-01-27 22:29:16,205 - portfolio_analyzer - DEBUG - Calculating portfolio metrics...
2025-01-27 22:29:16,205 - portfolio_analyzer - ERROR - Error calculating portfolio returns: 'Adj Close'
2025-01-27 22:29:16,206 - portfolio_analyzer - ERROR - An error occurred during portfolio analysis: 'Adj Close'
Traceback (most recent call last):
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Adj Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\main.py", line 59, in main
    metrics = calculate_portfolio_metrics(processed_data, portfolio)
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\calculations.py", line 188, in calculate_portfolio_metrics
    portfolio_returns = calculate_portfolio_returns(processed_data, portfolio_weights)
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\calculations.py", line 36, in calculate_portfolio_returns
    price_data[ticker] = data['Adj Close']
                         ~~~~^^^^^^^^^^^^^
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\frame.py", line 4101, in __getitem__
    return self._getitem_multilevel(key)
           ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\frame.py", line 4159, in _getitem_multilevel
    loc = self.columns.get_loc(key)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\multi.py", line 3040, in get_loc
    loc = self._get_level_indexer(key, level=0)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\multi.py", line 3391, in _get_level_indexer
    idx = self._get_loc_single_level_index(level_index, key)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\multi.py", line 2980, in _get_loc_single_level_index
    return level_index.get_loc(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'Adj Close'
2025-01-27 22:32:04,022 - portfolio_analyzer - INFO - Starting portfolio analysis
2025-01-27 22:32:04,022 - portfolio_analyzer - INFO - Analyzing portfolio: {'AAPL': 0.4, 'MSFT': 0.3, 'GOOGL': 0.3}
2025-01-27 22:32:04,023 - portfolio_analyzer - INFO - Time period: 2020-01-01 to 2023-10-01
2025-01-27 22:32:04,023 - portfolio_analyzer - DEBUG - Fetching stock data...
2025-01-27 22:32:05,234 - portfolio_analyzer - DEBUG - Processing stock data...
2025-01-27 22:32:05,247 - portfolio_analyzer - DEBUG - Calculating portfolio metrics...
2025-01-27 22:32:05,248 - portfolio_analyzer - ERROR - Error calculating portfolio returns: 'Adj Close'
2025-01-27 22:32:05,248 - portfolio_analyzer - ERROR - An error occurred during portfolio analysis: 'Adj Close'
Traceback (most recent call last):
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Adj Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\main.py", line 59, in main
    metrics = calculate_portfolio_metrics(processed_data, portfolio)
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\calculations.py", line 188, in calculate_portfolio_metrics
    portfolio_returns = calculate_portfolio_returns(processed_data, portfolio_weights)
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\calculations.py", line 36, in calculate_portfolio_returns
    price_data[ticker] = data['Adj Close']
                         ~~~~^^^^^^^^^^^^^
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'Adj Close'
2025-01-27 22:32:42,019 - portfolio_analyzer - INFO - Starting portfolio analysis
2025-01-27 22:32:42,019 - portfolio_analyzer - INFO - Analyzing portfolio: {'AAPL': 0.4, 'MSFT': 0.3, 'GOOGL': 0.3}
2025-01-27 22:32:42,020 - portfolio_analyzer - INFO - Time period: 2020-01-01 to 2023-10-01
2025-01-27 22:32:42,020 - portfolio_analyzer - DEBUG - Fetching stock data...
2025-01-27 22:32:43,379 - portfolio_analyzer - DEBUG - Processing stock data...
2025-01-27 22:32:43,382 - portfolio_analyzer - DEBUG - Calculating portfolio metrics...
2025-01-27 22:32:43,764 - portfolio_analyzer - ERROR - An error occurred during portfolio analysis: 'Adj Close'
Traceback (most recent call last):
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Adj Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\main.py", line 59, in main
    metrics = calculate_portfolio_metrics(processed_data, portfolio)
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\calculations.py", line 187, in calculate_portfolio_metrics
    benchmark_returns = benchmark_data['^GSPC']['Adj Close'].pct_change().dropna()
                        ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\frame.py", line 4101, in __getitem__
    return self._getitem_multilevel(key)
           ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\frame.py", line 4159, in _getitem_multilevel
    loc = self.columns.get_loc(key)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\multi.py", line 3040, in get_loc
    loc = self._get_level_indexer(key, level=0)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\multi.py", line 3391, in _get_level_indexer
    idx = self._get_loc_single_level_index(level_index, key)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\multi.py", line 2980, in _get_loc_single_level_index
    return level_index.get_loc(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'Adj Close'
2025-01-27 22:33:49,404 - portfolio_analyzer - INFO - Starting portfolio analysis
2025-01-27 22:33:49,404 - portfolio_analyzer - INFO - Analyzing portfolio: {'AAPL': 0.4, 'MSFT': 0.3, 'GOOGL': 0.3}
2025-01-27 22:33:49,405 - portfolio_analyzer - INFO - Time period: 2020-01-01 to 2023-10-01
2025-01-27 22:33:49,405 - portfolio_analyzer - DEBUG - Fetching stock data...
2025-01-27 22:33:50,782 - portfolio_analyzer - DEBUG - Processing stock data...
2025-01-27 22:33:50,784 - portfolio_analyzer - DEBUG - Calculating portfolio metrics...
2025-01-27 22:33:51,047 - portfolio_analyzer - INFO - Portfolio Metrics:
2025-01-27 22:33:51,048 - portfolio_analyzer - INFO - Expected Return: 0.2574
2025-01-27 22:33:51,049 - portfolio_analyzer - INFO - Volatility: 0.3102
2025-01-27 22:33:51,049 - portfolio_analyzer - INFO - Sharpe Ratio: 0.7975
2025-01-27 22:33:51,050 - portfolio_analyzer - ERROR - An error occurred during portfolio analysis: unsupported format string passed to NoneType.__format__
Traceback (most recent call last):
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\main.py", line 64, in main
    logger.info(f"{key}: {value:.4f}")
                         ^^^^^^^^^^^
TypeError: unsupported format string passed to NoneType.__format__
2025-01-27 22:40:49,756 - portfolio_analyzer - INFO - Starting portfolio analysis
2025-01-27 22:40:49,757 - portfolio_analyzer - INFO - Analyzing portfolio: {'AAPL': 0.4, 'MSFT': 0.3, 'GOOGL': 0.3}
2025-01-27 22:40:49,757 - portfolio_analyzer - INFO - Time period: 2020-01-01 to 2023-10-01
2025-01-27 22:40:49,758 - portfolio_analyzer - DEBUG - Fetching stock data...
2025-01-27 22:40:51,235 - portfolio_analyzer - DEBUG - Processing stock data...
2025-01-27 22:40:51,237 - portfolio_analyzer - DEBUG - Calculating portfolio metrics...
2025-01-27 22:40:51,470 - portfolio_analyzer - INFO - Portfolio Metrics:
2025-01-27 22:40:51,470 - portfolio_analyzer - INFO - Expected Return: 0.2574
2025-01-27 22:40:51,471 - portfolio_analyzer - INFO - Volatility: 0.3102
2025-01-27 22:40:51,471 - portfolio_analyzer - INFO - Sharpe Ratio: 0.7975
2025-01-27 22:40:51,472 - portfolio_analyzer - INFO - Beta: Not available
2025-01-27 22:40:51,472 - portfolio_analyzer - INFO - VaR: nan
2025-01-27 22:40:51,472 - portfolio_analyzer - DEBUG - Generating visualizations...
2025-01-27 22:41:09,374 - portfolio_analyzer - ERROR - An error occurred during portfolio analysis: 'Adj Close'
Traceback (most recent call last):
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Adj Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\main.py", line 72, in main
    plot_individual_assets(processed_data)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\visualization.py", line 113, in plot_individual_assets
    price_data[ticker] = data['Adj Close']
                         ~~~~^^^^^^^^^^^^^
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'Adj Close'
2025-01-27 22:54:57,409 - portfolio_analyzer - INFO - Starting portfolio analysis
2025-01-27 22:54:57,409 - portfolio_analyzer - INFO - Analyzing portfolio: {'AAPL': 0.4, 'MSFT': 0.3, 'GOOGL': 0.3}
2025-01-27 22:54:57,410 - portfolio_analyzer - INFO - Time period: 2020-01-01 to 2023-10-01
2025-01-27 22:54:57,410 - portfolio_analyzer - DEBUG - Fetching stock data...
2025-01-27 22:54:59,020 - portfolio_analyzer - DEBUG - Processing stock data...
2025-01-27 22:54:59,022 - portfolio_analyzer - DEBUG - Calculating portfolio metrics...
2025-01-27 22:54:59,286 - portfolio_analyzer - INFO - Portfolio Metrics:
2025-01-27 22:54:59,287 - portfolio_analyzer - INFO - Expected Return: 0.2574
2025-01-27 22:54:59,287 - portfolio_analyzer - INFO - Volatility: 0.3102
2025-01-27 22:54:59,288 - portfolio_analyzer - INFO - Sharpe Ratio: 0.7975
2025-01-27 22:54:59,289 - portfolio_analyzer - INFO - Beta: Not available
2025-01-27 22:54:59,289 - portfolio_analyzer - INFO - VaR: nan
2025-01-27 22:54:59,290 - portfolio_analyzer - DEBUG - Generating visualizations...
2025-01-27 22:57:36,915 - portfolio_analyzer - ERROR - An error occurred during portfolio analysis: 'Adj Close'
Traceback (most recent call last):
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Adj Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\main.py", line 72, in main
    plot_individual_assets(processed_data)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\visualization.py", line 113, in plot_individual_assets
    price_data[ticker] = data['Adj Close']
                         ~~~~^^^^^^^^^^^^^
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'Adj Close'
2025-01-27 22:58:09,988 - portfolio_analyzer - INFO - Starting portfolio analysis
2025-01-27 22:58:09,988 - portfolio_analyzer - INFO - Analyzing portfolio: {'AAPL': 0.4, 'MSFT': 0.3, 'GOOGL': 0.3}
2025-01-27 22:58:09,989 - portfolio_analyzer - INFO - Time period: 2020-01-01 to 2024-12-31
2025-01-27 22:58:09,989 - portfolio_analyzer - DEBUG - Fetching stock data...
2025-01-27 22:58:11,570 - portfolio_analyzer - DEBUG - Processing stock data...
2025-01-27 22:58:11,572 - portfolio_analyzer - DEBUG - Calculating portfolio metrics...
2025-01-27 22:58:11,793 - portfolio_analyzer - INFO - Portfolio Metrics:
2025-01-27 22:58:11,794 - portfolio_analyzer - INFO - Expected Return: 0.2730
2025-01-27 22:58:11,795 - portfolio_analyzer - INFO - Volatility: 0.2840
2025-01-27 22:58:11,796 - portfolio_analyzer - INFO - Sharpe Ratio: 0.9259
2025-01-27 22:58:11,796 - portfolio_analyzer - INFO - Beta: Not available
2025-01-27 22:58:11,797 - portfolio_analyzer - INFO - VaR: nan
2025-01-27 22:58:11,797 - portfolio_analyzer - DEBUG - Generating visualizations...
2025-01-27 22:58:19,429 - portfolio_analyzer - ERROR - An error occurred during portfolio analysis: 'Adj Close'
Traceback (most recent call last):
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Adj Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\main.py", line 72, in main
    plot_individual_assets(processed_data)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\visualization.py", line 113, in plot_individual_assets
    price_data[ticker] = data['Adj Close']
                         ~~~~^^^^^^^^^^^^^
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'Adj Close'
2025-01-27 22:59:32,855 - portfolio_analyzer - INFO - Starting portfolio analysis
2025-01-27 22:59:32,856 - portfolio_analyzer - INFO - Analyzing portfolio: {'AAPL': 0.4, 'MSFT': 0.3, 'GOOGL': 0.3}
2025-01-27 22:59:32,856 - portfolio_analyzer - INFO - Time period: 2020-01-01 to 2024-12-31
2025-01-27 22:59:32,856 - portfolio_analyzer - DEBUG - Fetching stock data...
2025-01-27 22:59:34,244 - portfolio_analyzer - DEBUG - Fetching benchmark data...
2025-01-27 22:59:34,401 - portfolio_analyzer - ERROR - An error occurred during portfolio analysis: 'Adj Close'
Traceback (most recent call last):
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Adj Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\main.py", line 57, in main
    benchmark_prices = benchmark_data['^GSPC'].get('Close', benchmark_data['^GSPC']['Adj Close'])
                                                            ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\frame.py", line 4101, in __getitem__
    return self._getitem_multilevel(key)
           ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\frame.py", line 4159, in _getitem_multilevel
    loc = self.columns.get_loc(key)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\multi.py", line 3040, in get_loc
    loc = self._get_level_indexer(key, level=0)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\multi.py", line 3391, in _get_level_indexer
    idx = self._get_loc_single_level_index(level_index, key)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\multi.py", line 2980, in _get_loc_single_level_index
    return level_index.get_loc(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'Adj Close'
2025-01-27 22:59:51,021 - portfolio_analyzer - INFO - Starting portfolio analysis
2025-01-27 22:59:51,021 - portfolio_analyzer - INFO - Analyzing portfolio: {'AAPL': 0.4, 'MSFT': 0.3, 'GOOGL': 0.3}
2025-01-27 22:59:51,022 - portfolio_analyzer - INFO - Time period: 2020-01-01 to 2024-12-31
2025-01-27 22:59:51,022 - portfolio_analyzer - DEBUG - Fetching stock data...
2025-01-27 22:59:52,300 - portfolio_analyzer - DEBUG - Fetching benchmark data...
2025-01-27 22:59:52,557 - portfolio_analyzer - ERROR - An error occurred during portfolio analysis: 'Adj Close'
Traceback (most recent call last):
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Adj Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\main.py", line 57, in main
    benchmark_prices = benchmark_data['^GSPC'].get('Close', benchmark_data['^GSPC']['Adj Close'])
                                                            ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\frame.py", line 4101, in __getitem__
    return self._getitem_multilevel(key)
           ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\frame.py", line 4159, in _getitem_multilevel
    loc = self.columns.get_loc(key)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\multi.py", line 3040, in get_loc
    loc = self._get_level_indexer(key, level=0)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\multi.py", line 3391, in _get_level_indexer
    idx = self._get_loc_single_level_index(level_index, key)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\multi.py", line 2980, in _get_loc_single_level_index
    return level_index.get_loc(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'Adj Close'
2025-01-27 23:00:26,307 - portfolio_analyzer - INFO - Starting portfolio analysis
2025-01-27 23:00:26,307 - portfolio_analyzer - INFO - Analyzing portfolio: {'AAPL': 0.4, 'MSFT': 0.3, 'GOOGL': 0.3}
2025-01-27 23:00:26,308 - portfolio_analyzer - INFO - Time period: 2020-01-01 to 2024-12-31
2025-01-27 23:00:26,308 - portfolio_analyzer - DEBUG - Fetching stock data...
2025-01-27 23:00:27,521 - portfolio_analyzer - DEBUG - Fetching benchmark data...
2025-01-27 23:00:27,688 - portfolio_analyzer - ERROR - An error occurred during portfolio analysis: 'Adj Close'
Traceback (most recent call last):
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Adj Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\main.py", line 57, in main
    benchmark_prices = benchmark_data['^GSPC'].get('Close', benchmark_data['^GSPC']['Adj Close'])
                                                            ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\frame.py", line 4101, in __getitem__
    return self._getitem_multilevel(key)
           ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\frame.py", line 4159, in _getitem_multilevel
    loc = self.columns.get_loc(key)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\multi.py", line 3040, in get_loc
    loc = self._get_level_indexer(key, level=0)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\multi.py", line 3391, in _get_level_indexer
    idx = self._get_loc_single_level_index(level_index, key)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\multi.py", line 2980, in _get_loc_single_level_index
    return level_index.get_loc(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'Adj Close'
2025-01-27 23:01:10,614 - portfolio_analyzer - INFO - Starting portfolio analysis
2025-01-27 23:01:10,615 - portfolio_analyzer - INFO - Analyzing portfolio: {'AAPL': 0.4, 'MSFT': 0.3, 'GOOGL': 0.3}
2025-01-27 23:01:10,615 - portfolio_analyzer - INFO - Time period: 2020-01-01 to 2024-12-31
2025-01-27 23:01:10,616 - portfolio_analyzer - DEBUG - Fetching stock data...
2025-01-27 23:01:12,091 - portfolio_analyzer - DEBUG - Fetching benchmark data...
2025-01-27 23:01:12,317 - portfolio_analyzer - DEBUG - Processing stock data...
2025-01-27 23:01:12,317 - portfolio_analyzer - ERROR - An error occurred during portfolio analysis: 'Close'
Traceback (most recent call last):
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\main.py", line 65, in main
    processed_data = process_stock_data(raw_data)
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\data_processing.py", line 26, in process_stock_data
    processed_data[ticker] = data['Close'].copy()
                             ~~~~^^^^^^^^^
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'
2025-01-27 23:01:48,520 - portfolio_analyzer - INFO - Starting portfolio analysis
2025-01-27 23:01:48,521 - portfolio_analyzer - INFO - Analyzing portfolio: {'AAPL': 0.4, 'MSFT': 0.3, 'GOOGL': 0.3}
2025-01-27 23:01:48,521 - portfolio_analyzer - INFO - Time period: 2020-01-01 to 2024-12-31
2025-01-27 23:01:48,522 - portfolio_analyzer - DEBUG - Fetching stock data...
2025-01-27 23:01:49,843 - portfolio_analyzer - DEBUG - Fetching benchmark data...
2025-01-27 23:01:50,045 - portfolio_analyzer - DEBUG - Processing stock data...
2025-01-27 23:01:50,047 - portfolio_analyzer - DEBUG - Calculating portfolio metrics...
2025-01-27 23:01:50,330 - portfolio_analyzer - ERROR - An error occurred during portfolio analysis: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\main.py", line 76, in main
    information_ratio = excess_return / tracking_error if tracking_error != 0 else None
                                                          ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
    ...<2 lines>...
    )
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-01-27 23:03:11,598 - portfolio_analyzer - INFO - Starting portfolio analysis
2025-01-27 23:03:11,599 - portfolio_analyzer - INFO - Analyzing portfolio: {'AAPL': 0.4, 'MSFT': 0.3, 'GOOGL': 0.3}
2025-01-27 23:03:11,599 - portfolio_analyzer - INFO - Time period: 2020-01-01 to 2024-12-31
2025-01-27 23:03:11,600 - portfolio_analyzer - DEBUG - Fetching stock data...
2025-01-27 23:03:12,910 - portfolio_analyzer - DEBUG - Fetching benchmark data...
2025-01-27 23:03:13,095 - portfolio_analyzer - DEBUG - Processing stock data...
2025-01-27 23:03:13,096 - portfolio_analyzer - DEBUG - Calculating portfolio metrics...
2025-01-27 23:03:13,375 - portfolio_analyzer - WARNING - : The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-01-27 23:03:13,377 - portfolio_analyzer - INFO - Portfolio Metrics:
2025-01-27 23:03:13,377 - portfolio_analyzer - INFO - Expected Return: 0.2730
2025-01-27 23:03:13,377 - portfolio_analyzer - INFO - Volatility: 0.2840
2025-01-27 23:03:13,378 - portfolio_analyzer - INFO - Sharpe Ratio: 0.9259
2025-01-27 23:03:13,378 - portfolio_analyzer - INFO - Beta: 1.1613
2025-01-27 23:03:13,378 - portfolio_analyzer - INFO - VaR: nan
2025-01-27 23:03:13,379 - portfolio_analyzer - INFO - Excess Return: Not available
2025-01-27 23:03:13,379 - portfolio_analyzer - INFO - Tracking Error: Not available
2025-01-27 23:03:13,380 - portfolio_analyzer - INFO - Information Ratio: Not available
2025-01-27 23:03:13,380 - portfolio_analyzer - DEBUG - Generating visualizations...
2025-01-27 23:03:14,135 - portfolio_analyzer - DEBUG -  5000 
2025-01-27 23:03:15,229 - portfolio_analyzer - DEBUG - Efficient frontier plot generated successfully
2025-01-27 23:03:42,736 - portfolio_analyzer - DEBUG - Running Monte Carlo simulation...
2025-01-27 23:03:42,736 - portfolio_analyzer - INFO - 1000
2025-01-27 23:03:42,737 - portfolio_analyzer - ERROR - : If using all scalar values, you must pass an index
2025-01-27 23:03:42,737 - portfolio_analyzer - ERROR - An error occurred during portfolio analysis: If using all scalar values, you must pass an index
Traceback (most recent call last):
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\main.py", line 105, in main
    simulation_results = monte_carlo_simulation(processed_data, portfolio)
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\calculations.py", line 126, in monte_carlo_simulation
    price_data = pd.DataFrame(processed_data)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 114, in arrays_to_mgr
    index = _extract_index(arrays)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 667, in _extract_index
    raise ValueError("If using all scalar values, you must pass an index")
ValueError: If using all scalar values, you must pass an index
2025-01-27 23:04:13,503 - portfolio_analyzer - INFO - Starting portfolio analysis
2025-01-27 23:04:13,504 - portfolio_analyzer - INFO - Analyzing portfolio: {'AAPL': 0.4, 'MSFT': 0.3, 'GOOGL': 0.3}
2025-01-27 23:04:13,504 - portfolio_analyzer - INFO - Time period: 2020-01-01 to 2024-12-31
2025-01-27 23:04:13,504 - portfolio_analyzer - DEBUG - Fetching stock data...
2025-01-27 23:04:14,867 - portfolio_analyzer - DEBUG - Fetching benchmark data...
2025-01-27 23:04:15,066 - portfolio_analyzer - DEBUG - Processing stock data...
2025-01-27 23:04:15,068 - portfolio_analyzer - DEBUG - Calculating portfolio metrics...
2025-01-27 23:04:15,330 - portfolio_analyzer - WARNING - : The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-01-27 23:04:15,331 - portfolio_analyzer - INFO - Portfolio Metrics:
2025-01-27 23:04:15,331 - portfolio_analyzer - INFO - Expected Return: 0.2730
2025-01-27 23:04:15,332 - portfolio_analyzer - INFO - Volatility: 0.2840
2025-01-27 23:04:15,332 - portfolio_analyzer - INFO - Sharpe Ratio: 0.9259
2025-01-27 23:04:15,332 - portfolio_analyzer - INFO - Beta: 1.1613
2025-01-27 23:04:15,333 - portfolio_analyzer - INFO - VaR: nan
2025-01-27 23:04:15,333 - portfolio_analyzer - INFO - Excess Return: Not available
2025-01-27 23:04:15,333 - portfolio_analyzer - INFO - Tracking Error: Not available
2025-01-27 23:04:15,334 - portfolio_analyzer - INFO - Information Ratio: Not available
2025-01-27 23:04:15,334 - portfolio_analyzer - DEBUG - Generating visualizations...
2025-01-27 23:04:16,019 - portfolio_analyzer - DEBUG -  5000 
2025-01-27 23:04:17,105 - portfolio_analyzer - DEBUG - Efficient frontier plot generated successfully
2025-01-27 23:04:21,412 - portfolio_analyzer - DEBUG - Running Monte Carlo simulation...
2025-01-27 23:04:21,413 - portfolio_analyzer - INFO - 1000
2025-01-27 23:04:21,413 - portfolio_analyzer - ERROR - : If using all scalar values, you must pass an index
2025-01-27 23:04:21,414 - portfolio_analyzer - ERROR - An error occurred during portfolio analysis: If using all scalar values, you must pass an index
Traceback (most recent call last):
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\main.py", line 105, in main
    simulation_results = monte_carlo_simulation(processed_data, portfolio)
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\calculations.py", line 126, in monte_carlo_simulation
    price_data = pd.DataFrame(processed_data)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 114, in arrays_to_mgr
    index = _extract_index(arrays)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 667, in _extract_index
    raise ValueError("If using all scalar values, you must pass an index")
ValueError: If using all scalar values, you must pass an index
2025-01-27 23:11:54,464 - portfolio_analyzer - INFO - Starting portfolio analysis
2025-01-27 23:11:54,465 - portfolio_analyzer - INFO - Analyzing portfolio: {'AAPL': 0.4, 'MSFT': 0.3, 'GOOGL': 0.3}
2025-01-27 23:11:54,465 - portfolio_analyzer - INFO - Time period: 2020-01-01 to 2024-12-31
2025-01-27 23:11:54,466 - portfolio_analyzer - DEBUG - Fetching stock data...
2025-01-27 23:11:55,945 - portfolio_analyzer - DEBUG - Fetching benchmark data...
2025-01-27 23:11:56,182 - portfolio_analyzer - DEBUG - Processing stock data...
2025-01-27 23:11:56,183 - portfolio_analyzer - DEBUG - Calculating portfolio metrics...
2025-01-27 23:11:56,495 - portfolio_analyzer - WARNING - : The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-01-27 23:11:56,496 - portfolio_analyzer - INFO - Portfolio Metrics:
2025-01-27 23:11:56,497 - portfolio_analyzer - INFO - Expected Return: 0.2730
2025-01-27 23:11:56,497 - portfolio_analyzer - INFO - Volatility: 0.2840
2025-01-27 23:11:56,498 - portfolio_analyzer - INFO - Sharpe Ratio: 0.9259
2025-01-27 23:11:56,498 - portfolio_analyzer - INFO - Beta: 1.1613
2025-01-27 23:11:56,498 - portfolio_analyzer - INFO - VaR: nan
2025-01-27 23:11:56,499 - portfolio_analyzer - INFO - Excess Return: Not available
2025-01-27 23:11:56,499 - portfolio_analyzer - INFO - Tracking Error: Not available
2025-01-27 23:11:56,499 - portfolio_analyzer - INFO - Information Ratio: Not available
2025-01-27 23:11:56,500 - portfolio_analyzer - DEBUG - Generating visualizations...
2025-01-27 23:11:57,056 - portfolio_analyzer - DEBUG -  5000 
2025-01-27 23:11:58,087 - portfolio_analyzer - DEBUG - Efficient frontier plot generated successfully
2025-01-27 23:12:34,032 - portfolio_analyzer - DEBUG - Running Monte Carlo simulation...
2025-01-27 23:12:34,033 - portfolio_analyzer - INFO - 1000
2025-01-27 23:12:34,033 - portfolio_analyzer - ERROR - : If using all scalar values, you must pass an index
2025-01-27 23:12:34,033 - portfolio_analyzer - ERROR - An error occurred during portfolio analysis: If using all scalar values, you must pass an index
Traceback (most recent call last):
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\main.py", line 105, in main
    simulation_results = monte_carlo_simulation(processed_data, portfolio)
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\calculations.py", line 126, in monte_carlo_simulation
    price_data = pd.DataFrame(processed_data)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 114, in arrays_to_mgr
    index = _extract_index(arrays)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 667, in _extract_index
    raise ValueError("If using all scalar values, you must pass an index")
ValueError: If using all scalar values, you must pass an index
2025-01-27 23:15:29,418 - portfolio_analyzer - INFO - Starting portfolio analysis
2025-01-27 23:15:29,418 - portfolio_analyzer - INFO - Analyzing portfolio: {'AAPL': 0.4, 'MSFT': 0.3, 'GOOGL': 0.3}
2025-01-27 23:15:29,419 - portfolio_analyzer - INFO - Time period: 2020-01-01 to 2024-12-31
2025-01-27 23:15:29,419 - portfolio_analyzer - DEBUG - Fetching stock data...
2025-01-27 23:15:30,953 - portfolio_analyzer - DEBUG - Fetching benchmark data...
2025-01-27 23:15:31,129 - portfolio_analyzer - DEBUG - Processing stock data...
2025-01-27 23:15:31,131 - portfolio_analyzer - DEBUG - Calculating portfolio metrics...
2025-01-27 23:15:31,405 - portfolio_analyzer - WARNING - : The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-01-27 23:15:31,405 - portfolio_analyzer - INFO - Portfolio Metrics:
2025-01-27 23:15:31,406 - portfolio_analyzer - INFO - Expected Return: 0.2730
2025-01-27 23:15:31,406 - portfolio_analyzer - INFO - Volatility: 0.2840
2025-01-27 23:15:31,406 - portfolio_analyzer - INFO - Sharpe Ratio: 0.9259
2025-01-27 23:15:31,407 - portfolio_analyzer - INFO - Beta: 1.1613
2025-01-27 23:15:31,407 - portfolio_analyzer - INFO - VaR: nan
2025-01-27 23:15:31,407 - portfolio_analyzer - INFO - Excess Return: Not available
2025-01-27 23:15:31,408 - portfolio_analyzer - INFO - Tracking Error: Not available
2025-01-27 23:15:31,408 - portfolio_analyzer - INFO - Information Ratio: Not available
2025-01-27 23:15:31,408 - portfolio_analyzer - DEBUG - Generating visualizations...
2025-01-27 23:15:31,963 - portfolio_analyzer - DEBUG -  5000 
2025-01-27 23:15:32,966 - portfolio_analyzer - DEBUG - Efficient frontier plot generated successfully
2025-01-27 23:15:37,796 - portfolio_analyzer - DEBUG - Running Monte Carlo simulation...
2025-01-27 23:15:37,796 - portfolio_analyzer - INFO - 1000
2025-01-27 23:15:37,797 - portfolio_analyzer - ERROR - : If using all scalar values, you must pass an index
2025-01-27 23:15:37,797 - portfolio_analyzer - ERROR - An error occurred during portfolio analysis: If using all scalar values, you must pass an index
Traceback (most recent call last):
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\main.py", line 105, in main
    simulation_results = monte_carlo_simulation(processed_data, portfolio)
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\calculations.py", line 126, in monte_carlo_simulation
    price_data = pd.DataFrame(processed_data)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 114, in arrays_to_mgr
    index = _extract_index(arrays)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 667, in _extract_index
    raise ValueError("If using all scalar values, you must pass an index")
ValueError: If using all scalar values, you must pass an index
2025-01-27 23:20:31,460 - portfolio_analyzer - INFO - Starting portfolio analysis
2025-01-27 23:20:31,461 - portfolio_analyzer - INFO - Analyzing portfolio: {'AAPL': 0.4, 'MSFT': 0.3, 'GOOGL': 0.3}
2025-01-27 23:20:31,461 - portfolio_analyzer - INFO - Time period: 2020-01-01 to 2024-12-31
2025-01-27 23:20:31,462 - portfolio_analyzer - DEBUG - Fetching stock data...
2025-01-27 23:20:32,912 - portfolio_analyzer - DEBUG - Fetching benchmark data...
2025-01-27 23:20:33,181 - portfolio_analyzer - DEBUG - Processing stock data...
2025-01-27 23:20:33,182 - portfolio_analyzer - DEBUG - Calculating portfolio metrics...
2025-01-27 23:20:33,441 - portfolio_analyzer - WARNING - : The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-01-27 23:20:33,442 - portfolio_analyzer - INFO - Portfolio Metrics:
2025-01-27 23:20:33,442 - portfolio_analyzer - INFO - Expected Return: 0.2730
2025-01-27 23:20:33,442 - portfolio_analyzer - INFO - Volatility: 0.2840
2025-01-27 23:20:33,443 - portfolio_analyzer - INFO - Sharpe Ratio: 0.9259
2025-01-27 23:20:33,443 - portfolio_analyzer - INFO - Beta: 1.1613
2025-01-27 23:20:33,443 - portfolio_analyzer - INFO - VaR: nan
2025-01-27 23:20:33,444 - portfolio_analyzer - INFO - Excess Return: Not available
2025-01-27 23:20:33,444 - portfolio_analyzer - INFO - Tracking Error: Not available
2025-01-27 23:20:33,444 - portfolio_analyzer - INFO - Information Ratio: Not available
2025-01-27 23:20:33,444 - portfolio_analyzer - DEBUG - Generating visualizations...
2025-01-27 23:20:34,000 - portfolio_analyzer - DEBUG -  5000 
2025-01-27 23:20:34,974 - portfolio_analyzer - DEBUG - Efficient frontier plot generated successfully
2025-01-27 23:20:45,589 - portfolio_analyzer - DEBUG - Running Monte Carlo simulation...
2025-01-27 23:20:45,589 - portfolio_analyzer - INFO - 1000
2025-01-27 23:20:45,590 - portfolio_analyzer - ERROR - : If using all scalar values, you must pass an index
2025-01-27 23:20:45,591 - portfolio_analyzer - ERROR - An error occurred during portfolio analysis: If using all scalar values, you must pass an index
Traceback (most recent call last):
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\main.py", line 105, in main
    simulation_results = monte_carlo_simulation(processed_data, portfolio)
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\calculations.py", line 126, in monte_carlo_simulation
    price_data = pd.DataFrame(processed_data)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 114, in arrays_to_mgr
    index = _extract_index(arrays)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 667, in _extract_index
    raise ValueError("If using all scalar values, you must pass an index")
ValueError: If using all scalar values, you must pass an index
2025-01-28 16:48:14,060 - portfolio_analyzer - INFO - Starting portfolio analysis
2025-01-28 16:48:14,062 - portfolio_analyzer - INFO - Analyzing portfolio: {'AAPL': 0.4, 'MSFT': 0.3, 'GOOGL': 0.3}
2025-01-28 16:48:14,062 - portfolio_analyzer - INFO - Time period: 2020-01-01 to 2024-12-31
2025-01-28 16:48:14,062 - portfolio_analyzer - DEBUG - Fetching stock data...
2025-01-28 16:48:15,750 - portfolio_analyzer - DEBUG - Fetching benchmark data...
2025-01-28 16:48:15,919 - portfolio_analyzer - DEBUG - Processing stock data...
2025-01-28 16:48:15,921 - portfolio_analyzer - DEBUG - Calculating portfolio metrics...
2025-01-28 16:48:16,188 - portfolio_analyzer - WARNING - : The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-01-28 16:48:16,190 - portfolio_analyzer - INFO - Portfolio Metrics:
2025-01-28 16:48:16,191 - portfolio_analyzer - INFO - Expected Return: 0.2730
2025-01-28 16:48:16,191 - portfolio_analyzer - INFO - Volatility: 0.2840
2025-01-28 16:48:16,191 - portfolio_analyzer - INFO - Sharpe Ratio: 0.9259
2025-01-28 16:48:16,192 - portfolio_analyzer - INFO - Beta: 1.1613
2025-01-28 16:48:16,192 - portfolio_analyzer - INFO - VaR: nan
2025-01-28 16:48:16,193 - portfolio_analyzer - INFO - Excess Return: Not available
2025-01-28 16:48:16,193 - portfolio_analyzer - INFO - Tracking Error: Not available
2025-01-28 16:48:16,193 - portfolio_analyzer - INFO - Information Ratio: Not available
2025-01-28 16:48:16,194 - portfolio_analyzer - DEBUG - Generating visualizations...
2025-01-28 16:48:16,809 - portfolio_analyzer - DEBUG -  5000 
2025-01-28 16:48:17,871 - portfolio_analyzer - DEBUG - Efficient frontier plot generated successfully
2025-01-28 16:48:33,836 - portfolio_analyzer - DEBUG - Running Monte Carlo simulation...
2025-01-28 16:48:33,837 - portfolio_analyzer - INFO - 1000
2025-01-28 16:48:33,837 - portfolio_analyzer - ERROR - : If using all scalar values, you must pass an index
2025-01-28 16:48:33,837 - portfolio_analyzer - ERROR - An error occurred during portfolio analysis: If using all scalar values, you must pass an index
Traceback (most recent call last):
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\main.py", line 105, in main
    simulation_results = monte_carlo_simulation(processed_data, portfolio)
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\calculations.py", line 126, in monte_carlo_simulation
    price_data = pd.DataFrame(processed_data)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 114, in arrays_to_mgr
    index = _extract_index(arrays)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 667, in _extract_index
    raise ValueError("If using all scalar values, you must pass an index")
ValueError: If using all scalar values, you must pass an index
2025-01-28 16:52:40,556 - portfolio_analyzer - INFO - Starting portfolio analysis
2025-01-28 16:52:40,557 - portfolio_analyzer - INFO - Analyzing portfolio: {'AAPL': 0.4, 'MSFT': 0.3, 'GOOGL': 0.3}
2025-01-28 16:52:40,557 - portfolio_analyzer - INFO - Time period: 2020-01-01 to 2024-12-31
2025-01-28 16:52:40,558 - portfolio_analyzer - DEBUG - Fetching stock data...
2025-01-28 16:52:42,075 - portfolio_analyzer - DEBUG - Fetching benchmark data...
2025-01-28 16:52:42,349 - portfolio_analyzer - DEBUG - Processing stock data...
2025-01-28 16:52:42,350 - portfolio_analyzer - DEBUG - Calculating portfolio metrics...
2025-01-28 16:52:42,648 - portfolio_analyzer - WARNING - : The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-01-28 16:52:42,648 - portfolio_analyzer - INFO - Portfolio Metrics:
2025-01-28 16:52:42,649 - portfolio_analyzer - INFO - Expected Return: 0.2730
2025-01-28 16:52:42,649 - portfolio_analyzer - INFO - Volatility: 0.2840
2025-01-28 16:52:42,649 - portfolio_analyzer - INFO - Sharpe Ratio: 0.9259
2025-01-28 16:52:42,650 - portfolio_analyzer - INFO - Beta: 1.1613
2025-01-28 16:52:42,650 - portfolio_analyzer - INFO - VaR: nan
2025-01-28 16:52:42,650 - portfolio_analyzer - INFO - Excess Return: Not available
2025-01-28 16:52:42,650 - portfolio_analyzer - INFO - Tracking Error: Not available
2025-01-28 16:52:42,651 - portfolio_analyzer - INFO - Information Ratio: Not available
2025-01-28 16:52:42,651 - portfolio_analyzer - DEBUG - Generating visualizations...
2025-01-28 16:52:53,127 - portfolio_analyzer - DEBUG -  5000 
2025-01-28 16:52:54,186 - portfolio_analyzer - DEBUG - Efficient frontier plot generated successfully
2025-01-28 16:52:56,999 - portfolio_analyzer - DEBUG - Running Monte Carlo simulation...
2025-01-28 16:52:56,999 - portfolio_analyzer - INFO - 1000
2025-01-28 16:52:56,999 - portfolio_analyzer - ERROR - : If using all scalar values, you must pass an index
2025-01-28 16:52:57,000 - portfolio_analyzer - ERROR - An error occurred during portfolio analysis: If using all scalar values, you must pass an index
Traceback (most recent call last):
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\main.py", line 105, in main
    simulation_results = monte_carlo_simulation(processed_data, portfolio)
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\calculations.py", line 126, in monte_carlo_simulation
    price_data = pd.DataFrame(processed_data)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 114, in arrays_to_mgr
    index = _extract_index(arrays)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 667, in _extract_index
    raise ValueError("If using all scalar values, you must pass an index")
ValueError: If using all scalar values, you must pass an index
2025-01-28 16:53:04,733 - portfolio_analyzer - INFO - Starting portfolio analysis
2025-01-28 16:53:04,734 - portfolio_analyzer - INFO - Analyzing portfolio: {'AAPL': 0.4, 'MSFT': 0.3, 'GOOGL': 0.3}
2025-01-28 16:53:04,734 - portfolio_analyzer - INFO - Time period: 2020-01-01 to 2024-12-31
2025-01-28 16:53:04,735 - portfolio_analyzer - DEBUG - Fetching stock data...
2025-01-28 16:53:06,111 - portfolio_analyzer - DEBUG - Fetching benchmark data...
2025-01-28 16:53:06,317 - portfolio_analyzer - DEBUG - Processing stock data...
2025-01-28 16:53:06,319 - portfolio_analyzer - DEBUG - Calculating portfolio metrics...
2025-01-28 16:53:06,600 - portfolio_analyzer - WARNING - : The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-01-28 16:53:06,601 - portfolio_analyzer - INFO - Portfolio Metrics:
2025-01-28 16:53:06,601 - portfolio_analyzer - INFO - Expected Return: 0.2730
2025-01-28 16:53:06,601 - portfolio_analyzer - INFO - Volatility: 0.2840
2025-01-28 16:53:06,601 - portfolio_analyzer - INFO - Sharpe Ratio: 0.9259
2025-01-28 16:53:06,601 - portfolio_analyzer - INFO - Beta: 1.1613
2025-01-28 16:53:06,602 - portfolio_analyzer - INFO - VaR: nan
2025-01-28 16:53:06,602 - portfolio_analyzer - INFO - Excess Return: Not available
2025-01-28 16:53:06,602 - portfolio_analyzer - INFO - Tracking Error: Not available
2025-01-28 16:53:06,602 - portfolio_analyzer - INFO - Information Ratio: Not available
2025-01-28 16:53:06,602 - portfolio_analyzer - DEBUG - Generating visualizations...
2025-01-28 16:53:10,178 - portfolio_analyzer - DEBUG -  5000 
2025-01-28 16:53:11,204 - portfolio_analyzer - DEBUG - Efficient frontier plot generated successfully
2025-01-28 16:53:14,419 - portfolio_analyzer - DEBUG - Running Monte Carlo simulation...
2025-01-28 16:53:14,419 - portfolio_analyzer - INFO - 1000
2025-01-28 16:53:14,419 - portfolio_analyzer - ERROR - : If using all scalar values, you must pass an index
2025-01-28 16:53:14,419 - portfolio_analyzer - ERROR - An error occurred during portfolio analysis: If using all scalar values, you must pass an index
Traceback (most recent call last):
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\main.py", line 105, in main
    simulation_results = monte_carlo_simulation(processed_data, portfolio)
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\calculations.py", line 126, in monte_carlo_simulation
    price_data = pd.DataFrame(processed_data)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 114, in arrays_to_mgr
    index = _extract_index(arrays)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 667, in _extract_index
    raise ValueError("If using all scalar values, you must pass an index")
ValueError: If using all scalar values, you must pass an index
2025-01-28 16:54:29,328 - portfolio_analyzer - INFO - Starting portfolio analysis
2025-01-28 16:54:29,329 - portfolio_analyzer - INFO - Analyzing portfolio: {'AAPL': 0.4, 'MSFT': 0.3, 'GOOGL': 0.3}
2025-01-28 16:54:29,329 - portfolio_analyzer - INFO - Time period: 2020-01-01 to 2024-12-31
2025-01-28 16:54:29,330 - portfolio_analyzer - DEBUG - Fetching stock data...
2025-01-28 16:54:30,753 - portfolio_analyzer - DEBUG - Fetching benchmark data...
2025-01-28 16:54:30,966 - portfolio_analyzer - DEBUG - Processing stock data...
2025-01-28 16:54:30,968 - portfolio_analyzer - DEBUG - Calculating portfolio metrics...
2025-01-28 16:54:31,228 - portfolio_analyzer - WARNING - : The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-01-28 16:54:31,228 - portfolio_analyzer - INFO - Portfolio Metrics:
2025-01-28 16:54:31,229 - portfolio_analyzer - INFO - Expected Return: 0.2730
2025-01-28 16:54:31,229 - portfolio_analyzer - INFO - Volatility: 0.2840
2025-01-28 16:54:31,229 - portfolio_analyzer - INFO - Sharpe Ratio: 0.9259
2025-01-28 16:54:31,229 - portfolio_analyzer - INFO - Beta: 1.1613
2025-01-28 16:54:31,229 - portfolio_analyzer - INFO - VaR: nan
2025-01-28 16:54:31,229 - portfolio_analyzer - INFO - Excess Return: Not available
2025-01-28 16:54:31,230 - portfolio_analyzer - INFO - Tracking Error: Not available
2025-01-28 16:54:31,230 - portfolio_analyzer - INFO - Information Ratio: Not available
2025-01-28 16:54:31,230 - portfolio_analyzer - DEBUG - Generating visualizations...
2025-01-28 16:54:31,484 - portfolio_analyzer - ERROR - An error occurred during portfolio analysis: 'CheckButtons' object has no attribute 'rectangles'
Traceback (most recent call last):
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\main.py", line 98, in main
    plot_portfolio_performance(portfolio_returns, benchmark_returns)  # 
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\visualization.py", line 60, in plot_portfolio_performance
    for rect in check.rectangles:
                ^^^^^^^^^^^^^^^^
AttributeError: 'CheckButtons' object has no attribute 'rectangles'
2025-01-28 16:55:27,239 - portfolio_analyzer - INFO - Starting portfolio analysis
2025-01-28 16:55:27,240 - portfolio_analyzer - INFO - Analyzing portfolio: {'AAPL': 0.4, 'MSFT': 0.3, 'GOOGL': 0.3}
2025-01-28 16:55:27,240 - portfolio_analyzer - INFO - Time period: 2020-01-01 to 2024-12-31
2025-01-28 16:55:27,240 - portfolio_analyzer - DEBUG - Fetching stock data...
2025-01-28 16:55:28,662 - portfolio_analyzer - DEBUG - Fetching benchmark data...
2025-01-28 16:55:28,881 - portfolio_analyzer - DEBUG - Processing stock data...
2025-01-28 16:55:28,883 - portfolio_analyzer - DEBUG - Calculating portfolio metrics...
2025-01-28 16:55:29,136 - portfolio_analyzer - WARNING - : The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-01-28 16:55:29,137 - portfolio_analyzer - INFO - Portfolio Metrics:
2025-01-28 16:55:29,138 - portfolio_analyzer - INFO - Expected Return: 0.2730
2025-01-28 16:55:29,138 - portfolio_analyzer - INFO - Volatility: 0.2840
2025-01-28 16:55:29,139 - portfolio_analyzer - INFO - Sharpe Ratio: 0.9259
2025-01-28 16:55:29,139 - portfolio_analyzer - INFO - Beta: 1.1613
2025-01-28 16:55:29,140 - portfolio_analyzer - INFO - VaR: nan
2025-01-28 16:55:29,140 - portfolio_analyzer - INFO - Excess Return: Not available
2025-01-28 16:55:29,140 - portfolio_analyzer - INFO - Tracking Error: Not available
2025-01-28 16:55:29,141 - portfolio_analyzer - INFO - Information Ratio: Not available
2025-01-28 16:55:29,141 - portfolio_analyzer - DEBUG - Generating visualizations...
2025-01-28 16:55:36,718 - portfolio_analyzer - DEBUG -  5000 
2025-01-28 16:55:37,760 - portfolio_analyzer - DEBUG - Efficient frontier plot generated successfully
2025-01-28 16:55:40,070 - portfolio_analyzer - DEBUG - Running Monte Carlo simulation...
2025-01-28 16:55:40,070 - portfolio_analyzer - INFO - 1000
2025-01-28 16:55:40,071 - portfolio_analyzer - ERROR - : If using all scalar values, you must pass an index
2025-01-28 16:55:40,071 - portfolio_analyzer - ERROR - An error occurred during portfolio analysis: If using all scalar values, you must pass an index
Traceback (most recent call last):
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\main.py", line 105, in main
    simulation_results = monte_carlo_simulation(processed_data, portfolio)
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\calculations.py", line 126, in monte_carlo_simulation
    price_data = pd.DataFrame(processed_data)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 114, in arrays_to_mgr
    index = _extract_index(arrays)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 667, in _extract_index
    raise ValueError("If using all scalar values, you must pass an index")
ValueError: If using all scalar values, you must pass an index
2025-01-28 17:01:17,237 - portfolio_analyzer - INFO - Starting portfolio analysis
2025-01-28 17:01:17,237 - portfolio_analyzer - INFO - Analyzing portfolio: {'AAPL': 0.4, 'MSFT': 0.3, 'GOOGL': 0.3}
2025-01-28 17:01:17,238 - portfolio_analyzer - INFO - Time period: 2020-01-01 to 2024-12-31
2025-01-28 17:01:17,238 - portfolio_analyzer - DEBUG - Fetching stock data...
2025-01-28 17:01:18,770 - portfolio_analyzer - DEBUG - Fetching benchmark data...
2025-01-28 17:01:18,958 - portfolio_analyzer - DEBUG - Processing stock data...
2025-01-28 17:01:18,959 - portfolio_analyzer - DEBUG - Calculating portfolio metrics...
2025-01-28 17:01:19,260 - portfolio_analyzer - WARNING - : The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-01-28 17:01:19,260 - portfolio_analyzer - INFO - Portfolio Metrics:
2025-01-28 17:01:19,261 - portfolio_analyzer - INFO - Expected Return: 0.2730
2025-01-28 17:01:19,261 - portfolio_analyzer - INFO - Volatility: 0.2840
2025-01-28 17:01:19,261 - portfolio_analyzer - INFO - Sharpe Ratio: 0.9259
2025-01-28 17:01:19,262 - portfolio_analyzer - INFO - Beta: 1.1613
2025-01-28 17:01:19,262 - portfolio_analyzer - INFO - VaR: nan
2025-01-28 17:01:19,262 - portfolio_analyzer - INFO - Excess Return: Not available
2025-01-28 17:01:19,263 - portfolio_analyzer - INFO - Tracking Error: Not available
2025-01-28 17:01:19,263 - portfolio_analyzer - INFO - Information Ratio: Not available
2025-01-28 17:01:19,263 - portfolio_analyzer - DEBUG - Generating visualizations...
2025-01-28 17:01:28,247 - portfolio_analyzer - DEBUG -  5000 
2025-01-28 17:01:29,256 - portfolio_analyzer - DEBUG - Efficient frontier plot generated successfully
2025-01-28 17:01:32,488 - portfolio_analyzer - DEBUG - Running Monte Carlo simulation...
2025-01-28 17:01:32,489 - portfolio_analyzer - INFO - 1000
2025-01-28 17:01:32,489 - portfolio_analyzer - ERROR - : If using all scalar values, you must pass an index
2025-01-28 17:01:32,490 - portfolio_analyzer - ERROR - An error occurred during portfolio analysis: If using all scalar values, you must pass an index
Traceback (most recent call last):
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\main.py", line 105, in main
    simulation_results = monte_carlo_simulation(processed_data, portfolio)
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\calculations.py", line 126, in monte_carlo_simulation
    price_data = pd.DataFrame(processed_data)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 114, in arrays_to_mgr
    index = _extract_index(arrays)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 667, in _extract_index
    raise ValueError("If using all scalar values, you must pass an index")
ValueError: If using all scalar values, you must pass an index
2025-01-28 17:02:42,671 - portfolio_analyzer - INFO - Starting portfolio analysis
2025-01-28 17:02:42,671 - portfolio_analyzer - INFO - Analyzing portfolio: {'AAPL': 0.4, 'MSFT': 0.3, 'GOOGL': 0.3}
2025-01-28 17:02:42,672 - portfolio_analyzer - INFO - Time period: 2020-01-01 to 2024-12-31
2025-01-28 17:02:42,672 - portfolio_analyzer - DEBUG - Fetching stock data...
2025-01-28 17:02:44,288 - portfolio_analyzer - DEBUG - Fetching benchmark data...
2025-01-28 17:02:44,545 - portfolio_analyzer - DEBUG - Processing stock data...
2025-01-28 17:02:44,546 - portfolio_analyzer - DEBUG - Calculating portfolio metrics...
2025-01-28 17:02:44,844 - portfolio_analyzer - WARNING - : The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-01-28 17:02:44,844 - portfolio_analyzer - INFO - Portfolio Metrics:
2025-01-28 17:02:44,845 - portfolio_analyzer - INFO - Expected Return: 0.2730
2025-01-28 17:02:44,845 - portfolio_analyzer - INFO - Volatility: 0.2840
2025-01-28 17:02:44,846 - portfolio_analyzer - INFO - Sharpe Ratio: 0.9259
2025-01-28 17:02:44,846 - portfolio_analyzer - INFO - Beta: 1.1613
2025-01-28 17:02:44,846 - portfolio_analyzer - INFO - VaR: nan
2025-01-28 17:02:44,846 - portfolio_analyzer - INFO - Excess Return: Not available
2025-01-28 17:02:44,847 - portfolio_analyzer - INFO - Tracking Error: Not available
2025-01-28 17:02:44,847 - portfolio_analyzer - INFO - Information Ratio: Not available
2025-01-28 17:02:44,847 - portfolio_analyzer - DEBUG - Generating visualizations...
2025-01-28 17:04:32,908 - portfolio_analyzer - DEBUG -  5000 
2025-01-28 17:04:33,924 - portfolio_analyzer - DEBUG - Efficient frontier plot generated successfully
2025-01-28 17:04:36,935 - portfolio_analyzer - DEBUG - Running Monte Carlo simulation...
2025-01-28 17:04:36,935 - portfolio_analyzer - INFO - 1000
2025-01-28 17:04:36,936 - portfolio_analyzer - ERROR - : If using all scalar values, you must pass an index
2025-01-28 17:04:36,936 - portfolio_analyzer - ERROR - An error occurred during portfolio analysis: If using all scalar values, you must pass an index
Traceback (most recent call last):
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\main.py", line 105, in main
    simulation_results = monte_carlo_simulation(processed_data, portfolio)
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\calculations.py", line 126, in monte_carlo_simulation
    price_data = pd.DataFrame(processed_data)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 114, in arrays_to_mgr
    index = _extract_index(arrays)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 667, in _extract_index
    raise ValueError("If using all scalar values, you must pass an index")
ValueError: If using all scalar values, you must pass an index
2025-01-28 17:07:13,654 - portfolio_analyzer - INFO - Starting portfolio analysis
2025-01-28 17:07:13,655 - portfolio_analyzer - INFO - Analyzing portfolio: {'AAPL': 0.4, 'MSFT': 0.3, 'GOOGL': 0.3}
2025-01-28 17:07:13,655 - portfolio_analyzer - INFO - Time period: 2020-01-01 to 2024-12-31
2025-01-28 17:07:13,656 - portfolio_analyzer - DEBUG - Fetching stock data...
2025-01-28 17:07:15,208 - portfolio_analyzer - DEBUG - Fetching benchmark data...
2025-01-28 17:07:15,460 - portfolio_analyzer - DEBUG - Processing stock data...
2025-01-28 17:07:15,462 - portfolio_analyzer - DEBUG - Calculating portfolio metrics...
2025-01-28 17:07:15,756 - portfolio_analyzer - WARNING - : The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-01-28 17:07:15,756 - portfolio_analyzer - INFO - Portfolio Metrics:
2025-01-28 17:07:15,757 - portfolio_analyzer - INFO - Expected Return: 0.2730
2025-01-28 17:07:15,757 - portfolio_analyzer - INFO - Volatility: 0.2840
2025-01-28 17:07:15,757 - portfolio_analyzer - INFO - Sharpe Ratio: 0.9259
2025-01-28 17:07:15,758 - portfolio_analyzer - INFO - Beta: 1.1613
2025-01-28 17:07:15,758 - portfolio_analyzer - INFO - VaR: nan
2025-01-28 17:07:15,758 - portfolio_analyzer - INFO - Excess Return: Not available
2025-01-28 17:07:15,758 - portfolio_analyzer - INFO - Tracking Error: Not available
2025-01-28 17:07:15,759 - portfolio_analyzer - INFO - Information Ratio: Not available
2025-01-28 17:07:15,759 - portfolio_analyzer - DEBUG - Generating visualizations...
2025-01-28 17:10:23,783 - portfolio_analyzer - DEBUG -  5000 
2025-01-28 17:10:24,828 - portfolio_analyzer - DEBUG - Efficient frontier plot generated successfully
2025-01-28 17:10:49,316 - portfolio_analyzer - DEBUG - Running Monte Carlo simulation...
2025-01-28 17:10:49,316 - portfolio_analyzer - INFO - 1000
2025-01-28 17:10:49,317 - portfolio_analyzer - ERROR - : If using all scalar values, you must pass an index
2025-01-28 17:10:49,317 - portfolio_analyzer - ERROR - An error occurred during portfolio analysis: If using all scalar values, you must pass an index
Traceback (most recent call last):
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\main.py", line 105, in main
    simulation_results = monte_carlo_simulation(processed_data, portfolio)
  File "C:\Users\zougu\OneDrive\main\Dell NB\portfolio_analysis\calculations.py", line 126, in monte_carlo_simulation
    price_data = pd.DataFrame(processed_data)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 114, in arrays_to_mgr
    index = _extract_index(arrays)
  File "C:\Users\zougu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pandas\core\internals\construction.py", line 667, in _extract_index
    raise ValueError("If using all scalar values, you must pass an index")
ValueError: If using all scalar values, you must pass an index
